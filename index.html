<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Mistral Chat</title>
  <style>
    * { box-sizing: border-box; }

    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background: linear-gradient(to right, #0d0d0d, #1c1c1c);
      color: #f0f0f0;
    }

    .header, .footer {
      background: #111;
      padding: 15px;
      text-align: center;
    }

    .header h1 {
      color: #00bfff;
      margin: 0;
    }

    .container {
      max-width: 800px;
      margin: 20px auto;
      background: #222;
      border-radius: 12px;
      padding: 20px;
      box-shadow: 0 0 15px #000;
    }

    .chat-box {
      margin-top: 20px;
      max-height: 400px;
      overflow-y: auto;
      background: #000;
      padding: 15px;
      border-radius: 8px;
    }

    .user { color: #0f0; }
    .bot { color: #0af; margin-bottom: 10px; }

    textarea, select {
      width: 100%;
      margin-top: 10px;
      background: #333;
      border: 1px solid #444;
      color: #fff;
      padding: 10px;
      border-radius: 6px;
    }

    button {
      width: 100%;
      margin-top: 15px;
      padding: 12px;
      background: #00bfff;
      border: none;
      color: #fff;
      font-weight: bold;
      border-radius: 6px;
      cursor: pointer;
      transition: background 0.3s;
    }

    button:hover {
      background: #0099cc;
    }

    .controls {
      display: flex;
      justify-content: space-between;
      gap: 10px;
      margin-top: 20px;
    }

    .hidden {
      display: none;
    }

    .language-select {
      margin-top: 20px;
    }

    .confirmation {
      background: #111;
      padding: 20px;
      border-radius: 8px;
      text-align: center;
    }

    .confirmation button {
      width: auto;
      margin: 10px;
    }
  </style>
</head>
<body>
  <div class="header">
    <h1 id="title">üí¨ –ß–∞—Ç —Å Mistral</h1>
  </div>

  <div class="container" id="mainPage">
    <label id="labelMessage">üí¨ –í–∞—à–µ —Å–æ–æ–±—â–µ–Ω–∏–µ:</label>
    <textarea id="userInput" rows="3" placeholder="–ù–∞–ø–∏—à–∏—Ç–µ —á—Ç–æ-–Ω–∏–±—É–¥—å..."></textarea>

    <div class="language-select">
      <label id="labelLanguage">üåê –Ø–∑—ã–∫ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞:</label>
      <select id="languageSelect" onchange="changeLanguage()">
        <option value="ru">–†—É—Å—Å–∫–∏–π</option>
        <option value="en">English</option>
        <option value="es">Espa√±ol</option>
      </select>
    </div>

    <button onclick="startChat()">‚ñ∂Ô∏è –ù–∞—á–∞—Ç—å –¥–∏–∞–ª–æ–≥</button>
  </div>

  <div class="container hidden" id="chatPage">
    <div class="chat-box" id="chatBox">
      <p><i>üí¨ –ß–∞—Ç –Ω–∞—á–∞—Ç. –í–∞—à–∏ —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ—è–≤—è—Ç—Å—è –∑–¥–µ—Å—å.</i></p>
    </div>

    <textarea id="chatInput" rows="3" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..."></textarea>
    <button onclick="sendMessage()">‚úâÔ∏è –û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>

    <div class="controls">
      <button onclick="newDialog()">üîÑ –ù–æ–≤—ã–π –¥–∏–∞–ª–æ–≥</button>
      <button onclick="confirmExit()">üö™ –í—ã–π—Ç–∏</button>
    </div>
  </div>

  <div class="container hidden" id="confirmExitPage">
    <div class="confirmation">
      <p id="confirmText">–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –≤—ã–π—Ç–∏?</p>
      <button onclick="exitToMain()">‚úÖ –î–∞</button>
      <button onclick="cancelExit()">‚ùå –ù–µ—Ç</button>
    </div>
  </div>

  <div class="footer">
    <p>&copy; 2025 Mistral Chat</p>
  </div>

  <script>
    const API_KEY = "XY5HurrCbil8xtO95LLdpuk9YQ54LBJV";

    const langText = {
      ru: {
        title: "üí¨ –ß–∞—Ç —Å Mistral",
        labelMessage: "üí¨ –í–∞—à–µ —Å–æ–æ–±—â–µ–Ω–∏–µ:",
        labelLanguage: "üåê –Ø–∑—ã–∫ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞:",
        start: "‚ñ∂Ô∏è –ù–∞—á–∞—Ç—å –¥–∏–∞–ª–æ–≥",
        send: "‚úâÔ∏è –û—Ç–ø—Ä–∞–≤–∏—Ç—å",
        newDialog: "üîÑ –ù–æ–≤—ã–π –¥–∏–∞–ª–æ–≥",
        exit: "üö™ –í—ã–π—Ç–∏",
        confirm: "–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –≤—ã–π—Ç–∏?",
      },
      en: {
        title: "üí¨ Chat with Mistral",
        labelMessage: "üí¨ Your message:",
        labelLanguage: "üåê Interface language:",
        start: "‚ñ∂Ô∏è Start chat",
        send: "‚úâÔ∏è Send",
        newDialog: "üîÑ New dialog",
        exit: "üö™ Exit",
        confirm: "Are you sure you want to exit?",
      },
      es: {
        title: "üí¨ Chat con Mistral",
        labelMessage: "üí¨ Tu mensaje:",
        labelLanguage: "üåê Idioma de la interfaz:",
        start: "‚ñ∂Ô∏è Iniciar chat",
        send: "‚úâÔ∏è Enviar",
        newDialog: "üîÑ Nuevo di√°logo",
        exit: "üö™ Salir",
        confirm: "¬øEst√°s seguro de que quieres salir?",
      }
    };

    function changeLanguage() {
      const lang = document.getElementById("languageSelect").value;
      document.getElementById("title").textContent = langText[lang].title;
      document.getElementById("labelMessage").textContent = langText[lang].labelMessage;
      document.getElementById("labelLanguage").textContent = langText[lang].labelLanguage;
      document.querySelector("#mainPage button").textContent = langText[lang].start;
      document.querySelector("#chatPage button").textContent = langText[lang].send;
      document.querySelectorAll(".controls button")[0].textContent = langText[lang].newDialog;
      document.querySelectorAll(".controls button")[1].textContent = langText[lang].exit;
      document.getElementById("confirmText").textContent = langText[lang].confirm;
    }

    function startChat() {
      document.getElementById("mainPage").classList.add("hidden");
      document.getElementById("chatPage").classList.remove("hidden");

      const firstMsg = document.getElementById("userInput").value.trim();
      if (firstMsg) {
        document.getElementById("chatInput").value = firstMsg;
        sendMessage();
      }
    }

    function newDialog() {
      document.getElementById("chatBox").innerHTML = "<p><i>üí¨ –ù–æ–≤—ã–π –¥–∏–∞–ª–æ–≥ –Ω–∞—á–∞—Ç.</i></p>";
    }

    function confirmExit() {
      document.getElementById("chatPage").classList.add("hidden");
      document.getElementById("confirmExitPage").classList.remove("hidden");
    }

    function cancelExit() {
      document.getElementById("confirmExitPage").classList.add("hidden");
      document.getElementById("chatPage").classList.remove("hidden");
    }

    function exitToMain() {
      document.getElementById("confirmExitPage").classList.add("hidden");
      document.getElementById("mainPage").classList.remove("hidden");
      document.getElementById("chatBox").innerHTML = "";
      document.getElementById("userInput").value = "";
    }

    async function sendMessage() {
      const chatBox = document.getElementById("chatBox");
      const input = document.getElementById("chatInput");
      const message = input.value.trim();
      if (!message) return;

      chatBox.innerHTML += `<div class="user">üë§ ${message}</div>`;
      chatBox.innerHTML += `<div class="bot">ü§ñ ... –±–æ—Ç –¥—É–º–∞–µ—Ç ...</div>`;
      chatBox.scrollTop = chatBox.scrollHeight;

      input.value = "";

      try {
        const response = await fetch("https://api.mistral.ai/v1/chat/completions", {
          method: "POST",
          headers: {
            "Authorization": `Bearer ${API_KEY}`,
            "Content-Type": "application/json"
          },
          body: JSON.stringify({
            model: "mistral-small-latest",
            messages: [{ role: "user", content: message }],
            temperature: 0.7
          })
        });

        const data = await response.json();
        document.querySelectorAll(".bot").slice(-1)[0].remove();

        if (data.choices && data.choices.length > 0) {
          const reply = data.choices[0].message.content;
          chatBox.innerHTML += `<div class="bot">ü§ñ ${reply}</div>`;
        } else {
          chatBox.innerHTML += `<div class="bot">‚ùå –û—à–∏–±–∫–∞: ${JSON.stringify(data)}</div>`;
        }

        chatBox.scrollTop = chatBox.scrollHeight;
      } catch (err) {
        [...document.querySelectorAll(".bot")].slice(-1)[0].remove();
        chatBox.innerHTML += `<div class="bot">‚ùå –û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞: ${err.message}</div>`;
        chatBox.scrollTop = chatBox.scrollHeight;
      }
    }
  </script>
</body>
</html>
